<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Crear proyecto</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  </head>
  <body class="bg-gray-100 flex items-center justify-center h-screen">
    <div class="bg-white p-8 rounded shadow-md w-full max-w-md">
      <h2 class="text-2xl font-bold mb-6 text-center">Crear proyecto</h2>
      <form id="projectForm" class="space-y-4">
        <input type="text" id="titulo" placeholder="Título del proyecto" required class="w-full border rounded p-2" />
        <textarea id="contenido" placeholder="Descripción o contenido..." required class="w-full border rounded p-2"></textarea>
        <button type="submit" class="bg-green-600 text-white px-4 py-2 rounded w-full hover:bg-green-700">Crear</button>
      </form>
      <p class="mt-4 text-center text-sm"><a href="inicio.html" class="text-blue-600">Volver</a></p>
    </div>

    <script>
      const supabase = supabase.createClient(
        "https://bmvcxcqueeueesj1lg.supabase.co",
        "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJibXZjY3F3Y3VlZXVlc3BqbGlnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDkxNjY5MjgsImV4cCI6MjA2NDc0MjkyOH0.MS11K1Mhhha_GHh81_a3JtuQ4qBQWkeV2gNIGUAkieg"
      );

      document.getElementById("projectForm").addEventListener("submit", async function (e) {
        e.preventDefault();

        const { data: { user } } = await supabase.auth.getUser();
        if (!user) return alert("Debes iniciar sesión");

        const { error } = await supabase
          .from("proyectos")
          .insert([{
            titulo: document.getElementById("titulo").value,
            contenido: document.getElementById("contenido").value,
            user_id: user.id
          }]);

        if (error) {
          alert("Error: " + error.message);
        } else {
          alert("Proyecto creado");
          window.location.href = "panel-ceo.html";
        }
      });
    </script>
  </body>
</html>
